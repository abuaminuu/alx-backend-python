#!/bin/bash
# Backup Jenkins configuration
BACKUP_DIR="/backup/jenkins"
DATE=$(date +%Y%m%d_%H%M%S)

docker exec jenkins tar czf - /var/jenkins_home > $BACKUP_DIR/jenkins_backup_$DATE.tar.gz

# Keep only last 7 backups
ls -t $BACKUP_DIR/jenkins_backup_*.tar.gz | tail -n +8 | xargs rm -f
